<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>청소 관리 대시보드</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .stat-card {
            transition: transform 0.2s;
        }
        .stat-card:hover {
            transform: translateY(-4px);
        }
        .photo-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
        }
        .photo-modal img {
            max-width: 90%;
            max-height: 90%;
            margin: auto;
            display: block;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .photo-grid img {
            cursor: pointer;
            transition: transform 0.2s;
        }
        .photo-grid img:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- 헤더 -->
    <div class="bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 shadow-lg">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div>
                <h1 class="text-2xl font-bold flex items-center gap-2">
                    <i class="fas fa-chart-line"></i>
                    청소 관리 대시보드
                </h1>
                <p class="text-blue-100 text-sm mt-1">실시간 청소 현황 및 기록 조회</p>
            </div>
            <a href="index.html" class="px-4 py-2 bg-white text-blue-600 rounded-lg hover:bg-blue-50 font-bold">
                <i class="fas fa-arrow-left mr-2"></i>관리자로 돌아가기
            </a>
        </div>
    </div>

    <div class="max-w-7xl mx-auto p-4">
        <!-- 탭 네비게이션 -->
        <div class="bg-white rounded-lg shadow-md mb-4 overflow-x-auto">
            <div class="flex border-b">
                <button onclick="switchTab('overview')" id="tab-overview" 
                    class="flex-1 px-6 py-4 font-bold text-blue-600 border-b-2 border-blue-600 hover:bg-blue-50">
                    <i class="fas fa-chart-pie mr-2"></i>현황
                </button>
                <button onclick="switchTab('gallery')" id="tab-gallery" 
                    class="flex-1 px-6 py-4 font-bold text-gray-600 hover:bg-gray-50">
                    <i class="fas fa-images mr-2"></i>갤러리
                </button>
                <button onclick="switchTab('records')" id="tab-records" 
                    class="flex-1 px-6 py-4 font-bold text-gray-600 hover:bg-gray-50">
                    <i class="fas fa-list mr-2"></i>기록
                </button>
                <button onclick="switchTab('stats')" id="tab-stats" 
                    class="flex-1 px-6 py-4 font-bold text-gray-600 hover:bg-gray-50">
                    <i class="fas fa-chart-bar mr-2"></i>통계
                </button>
            </div>
        </div>
                <!-- 현황 탭 -->
        <div id="content-overview" class="space-y-4">
            <!-- 오늘의 요약 -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="stat-card bg-gradient-to-br from-green-500 to-green-600 text-white rounded-lg shadow-md p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-100 text-sm">오늘 완료</p>
                            <p class="text-4xl font-bold mt-2" id="stat-completed">0</p>
                        </div>
                        <i class="fas fa-check-circle text-5xl text-green-200"></i>
                    </div>
                </div>

                <div class="stat-card bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-lg shadow-md p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-100 text-sm">총 사진</p>
                            <p class="text-4xl font-bold mt-2" id="stat-photos">0</p>
                        </div>
                        <i class="fas fa-camera text-5xl text-blue-200"></i>
                    </div>
                </div>

                <div class="stat-card bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-lg shadow-md p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-100 text-sm">참여 직원</p>
                            <p class="text-4xl font-bold mt-2" id="stat-employees">0</p>
                        </div>
                        <i class="fas fa-users text-5xl text-purple-200"></i>
                    </div>
                </div>

                <div class="stat-card bg-gradient-to-br from-orange-500 to-orange-600 text-white rounded-lg shadow-md p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-orange-100 text-sm">청소 구역</p>
                            <p class="text-4xl font-bold mt-2" id="stat-locations">0</p>
                        </div>
                        <i class="fas fa-map-marker-alt text-5xl text-orange-200"></i>
                    </div>
                </div>
            </div>

            <!-- 구역별 현황 -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <i class="fas fa-map-marked-alt text-blue-600"></i>
                    구역별 청소 현황
                </h2>
                <div id="locationGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div class="text-center py-8 col-span-full text-gray-500">
                        <i class="fas fa-spinner fa-spin text-3xl mb-2"></i>
                        <p>데이터 로딩 중...</p>
                    </div>
                </div>
            </div>

            <!-- 최근 기록 -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <i class="fas fa-clock text-blue-600"></i>
                    최근 청소 기록
                </h2>
                <div id="recentRecords" class="space-y-3">
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-spinner fa-spin text-3xl mb-2"></i>
                        <p>데이터 로딩 중...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 갤러리 탭 -->
        <div id="content-gallery" class="hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex flex-wrap items-center gap-4 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                        <i class="fas fa-images text-blue-600"></i>
                        청소 사진 갤러리
                    </h2>
                    
                    <select id="galleryFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        onchange="filterGallery()">
                        <option value="all">전체 보기</option>
                        <option value="today">오늘</option>
                        <option value="week">이번 주</option>
                        <option value="month">이번 달</option>
                    </select>

                    <select id="galleryLocation" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        onchange="filterGallery()">
                        <option value="all">모든 구역</option>
                    </select>
                </div>

                <div id="photoGallery" class="photo-grid grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                    <div class="text-center py-8 col-span-full text-gray-500">
                        <i class="fas fa-spinner fa-spin text-3xl mb-2"></i>
                        <p>사진 로딩 중...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 기록 탭 -->
        <div id="content-records" class="hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex flex-wrap items-center gap-4 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                        <i class="fas fa-list text-blue-600"></i>
                        상세 청소 기록
                    </h2>

                    <input type="date" id="recordDate" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        onchange="filterRecords()">

                    <select id="recordEmployee" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        onchange="filterRecords()">
                        <option value="all">모든 직원</option>
                    </select>

                    <select id="recordLocation" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        onchange="filterRecords()">
                        <option value="all">모든 구역</option>
                    </select>
                </div>

                <div id="recordsList" class="space-y-4">
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-spinner fa-spin text-3xl mb-2"></i>
                        <p>기록 로딩 중...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 통계 탭 -->
        <div id="content-stats" class="hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <i class="fas fa-user-chart text-blue-600"></i>
                        직원별 청소 횟수
                    </h2>
                    <div id="employeeStats" class="space-y-3">
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-spinner fa-spin text-3xl mb-2"></i>
                            <p>통계 계산 중...</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <i class="fas fa-map-marked text-blue-600"></i>
                        구역별 청소 횟수
                    </h2>
                    <div id="locationStats" class="space-y-3">
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-spinner fa-spin text-3xl mb-2"></i>
                            <p>통계 계산 중...</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6 md:col-span-2">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <i class="fas fa-chart-line text-blue-600"></i>
                        주간 청소 추이
                    </h2>
                    <div id="weeklyStats" class="space-y-3">
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-spinner fa-spin text-3xl mb-2"></i>
                            <p>통계 계산 중...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="photoModal" class="photo-modal" onclick="closeModal()">
        <span style="position: absolute; top: 20px; right: 40px; color: white; font-size: 40px; cursor: pointer;">&times;</span>
        <img id="modalImage" src="" alt="사진 확대">
    </div>

    <script>
        const SUPABASE_URL = 'https://qgpqhtuynxhmgawakjxe.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_ujXj0mLf1casiQdVkc0fCA_G6exymqG';

        let allTasks = [];
        let currentTab = 'overview';

        window.onload = function() {
            loadAllData();
            setTodayDate();
        };

        function setTodayDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('recordDate').value = today;
        }

        async function loadAllData() {
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/cleaning_tasks?order=submitted_at.desc&limit=500`, {
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
                    }
                });

                if (!response.ok) throw new Error('데이터 로딩 실패');

                allTasks = await response.json();
                console.log('Loaded tasks:', allTasks.length);

                updateOverview();
                updateGallery();
                updateRecords();
                updateStats();
                populateFilters();
            } catch (error) {
                console.error('Error:', error);
                alert('데이터를 불러올 수 없습니다: ' + error.message);
            }
        }

        function switchTab(tab) {
            document.querySelectorAll('[id^="content-"]').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('[id^="tab-"]').forEach(el => {
                el.className = 'flex-1 px-6 py-4 font-bold text-gray-600 hover:bg-gray-50';
            });

            document.getElementById('content-' + tab).classList.remove('hidden');
            document.getElementById('tab-' + tab).className = 'flex-1 px-6 py-4 font-bold text-blue-600 border-b-2 border-blue-600 hover:bg-blue-50';
            currentTab = tab;
        }
              function updateOverview() {
            const today = new Date().toISOString().split('T')[0];
            const todayTasks = allTasks.filter(t => t.submitted_at.startsWith(today));

            document.getElementById('stat-completed').textContent = todayTasks.length;
            document.getElementById('stat-photos').textContent = todayTasks.reduce((sum, t) => sum + t.photo_count, 0);
            document.getElementById('stat-employees').textContent = new Set(todayTasks.map(t => t.employee_id)).size;
            document.getElementById('stat-locations').textContent = new Set(todayTasks.map(t => t.location_id)).size;

            const locationMap = {};
            todayTasks.forEach(task => {
                if (!locationMap[task.location_id]) {
                    locationMap[task.location_id] = { name: task.location_name, count: 0, photos: 0 };
                }
                locationMap[task.location_id].count++;
                locationMap[task.location_id].photos += task.photo_count;
            });

            const locationGrid = document.getElementById('locationGrid');
            const locations = Object.values(locationMap);

            if (locations.length === 0) {
                locationGrid.innerHTML = `<div class="col-span-full text-center py-8 text-gray-500"><i class="fas fa-inbox text-3xl mb-2"></i><p>오늘 청소 기록이 없습니다</p></div>`;
            } else {
                locationGrid.innerHTML = locations.map(loc => `
                    <div class="border border-gray-200 rounded-lg p-4 hover:border-blue-500 hover:shadow-md transition">
                        <div class="flex items-center gap-3 mb-3">
                            <i class="fas fa-map-marker-alt text-2xl text-blue-600"></i>
                            <div><p class="font-bold text-gray-800">${loc.name}</p><p class="text-sm text-gray-500">${loc.count}회 청소</p></div>
                        </div>
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-600"><i class="fas fa-camera mr-1"></i>${loc.photos}장</span>
                            <span class="text-green-600 font-bold"><i class="fas fa-check-circle mr-1"></i>완료</span>
                        </div>
                    </div>
                `).join('');
            }

            const recentRecords = document.getElementById('recentRecords');
            const recent = todayTasks.slice(0, 10);

            if (recent.length === 0) {
                recentRecords.innerHTML = `<div class="text-center py-8 text-gray-500"><i class="fas fa-inbox text-3xl mb-2"></i><p>최근 기록이 없습니다</p></div>`;
            } else {
                recentRecords.innerHTML = recent.map(task => `
                    <div class="border border-gray-200 rounded-lg p-4 hover:border-blue-500 hover:shadow-md transition">
                        <div class="flex items-start gap-4">
                            <img src="${task.photo_urls[0]}" alt="사진" class="w-20 h-20 object-cover rounded-lg cursor-pointer" onclick="openModal('${task.photo_urls[0]}')">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="font-bold text-gray-800">${task.employee_name}</span>
                                    <span class="text-gray-400">→</span>
                                    <span class="text-blue-600">${task.location_name}</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-2"><i class="fas fa-camera mr-1"></i>${task.photo_count}장 <i class="fas fa-clock ml-3 mr-1"></i>${formatDateTime(task.submitted_at)}</p>
                                ${task.notes ? `<p class="text-sm text-gray-500 italic">"${task.notes}"</p>` : ''}
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function updateGallery() { filterGallery(); }

        function filterGallery() {
            const filter = document.getElementById('galleryFilter').value;
            const locationFilter = document.getElementById('galleryLocation').value;
            let filtered = [...allTasks];

            const now = new Date();
            if (filter === 'today') {
                const today = now.toISOString().split('T')[0];
                filtered = filtered.filter(t => t.submitted_at.startsWith(today));
            } else if (filter === 'week') {
                const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                filtered = filtered.filter(t => new Date(t.submitted_at) >= weekAgo);
            } else if (filter === 'month') {
                const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                filtered = filtered.filter(t => new Date(t.submitted_at) >= monthAgo);
            }

            if (locationFilter !== 'all') {
                filtered = filtered.filter(t => t.location_id === locationFilter);
            }

            const photos = [];
            filtered.forEach(task => {
                task.photo_urls.forEach(url => {
                    photos.push({ url: url, employee: task.employee_name, location: task.location_name, date: task.submitted_at });
                });
            });

            const gallery = document.getElementById('photoGallery');

            if (photos.length === 0) {
                gallery.innerHTML = `<div class="col-span-full text-center py-8 text-gray-500"><i class="fas fa-inbox text-3xl mb-2"></i><p>사진이 없습니다</p></div>`;
            } else {
                gallery.innerHTML = photos.map(photo => `
                    <div class="relative group">
                        <img src="${photo.url}" alt="청소 사진" class="w-full h-48 object-cover rounded-lg shadow-md" onclick="openModal('${photo.url}')">
                        <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 text-white p-2 rounded-b-lg opacity-0 group-hover:opacity-100 transition">
                            <p class="text-xs font-bold">${photo.employee}</p>
                            <p class="text-xs">${photo.location}</p>
                        </div>
                    </div>
                `).join('');
            }
        }

        function updateRecords() { filterRecords(); }

        function filterRecords() {
            const dateFilter = document.getElementById('recordDate').value;
            const employeeFilter = document.getElementById('recordEmployee').value;
            const locationFilter = document.getElementById('recordLocation').value;

            let filtered = [...allTasks];

            if (dateFilter) filtered = filtered.filter(t => t.submitted_at.startsWith(dateFilter));
            if (employeeFilter !== 'all') filtered = filtered.filter(t => t.employee_id === employeeFilter);
            if (locationFilter !== 'all') filtered = filtered.filter(t => t.location_id === locationFilter);

            const recordsList = document.getElementById('recordsList');

            if (filtered.length === 0) {
                recordsList.innerHTML = `<div class="text-center py-8 text-gray-500"><i class="fas fa-inbox text-3xl mb-2"></i><p>조건에 맞는 기록이 없습니다</p></div>`;
            } else {
                recordsList.innerHTML = filtered.map(task => `
                    <div class="border border-gray-200 rounded-lg p-6 hover:border-blue-500 hover:shadow-md transition">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <h3 class="text-lg font-bold text-gray-800">${task.location_name}</h3>
                                <p class="text-sm text-gray-600"><i class="fas fa-user mr-1"></i>${task.employee_name} <i class="fas fa-clock ml-3 mr-1"></i>${formatDateTime(task.submitted_at)}</p>
                            </div>
                            <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-bold"><i class="fas fa-check-circle mr-1"></i>완료</span>
                        </div>
                        ${task.checklist_items.length > 0 ? `<div class="mb-4"><p class="text-sm font-bold text-gray-700 mb-2">완료 항목:</p><div class="flex flex-wrap gap-2">${task.checklist_items.map(item => `<span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs"><i class="fas fa-check mr-1"></i>${item}</span>`).join('')}</div></div>` : ''}
                        <div class="mb-4"><p class="text-sm font-bold text-gray-700 mb-2">사진 (${task.photo_count}장):</p><div class="grid grid-cols-4 gap-2">${task.photo_urls.map(url => `<img src="${url}" alt="청소 사진" class="w-full h-20 object-cover rounded cursor-pointer hover:opacity-80" onclick="openModal('${url}')">`).join('')}</div></div>
                        ${task.notes ? `<div class="bg-yellow-50 border-l-4 border-yellow-400 p-3 rounded"><p class="text-sm text-gray-700"><i class="fas fa-sticky-note text-yellow-600 mr-2"></i><strong>메모:</strong> ${task.notes}</p></div>` : ''}
                    </div>
                `).join('');
            }
        }

        function updateStats() {
            const employeeMap = {};
            allTasks.forEach(task => {
                if (!employeeMap[task.employee_id]) {
                    employeeMap[task.employee_id] = { name: task.employee_name, count: 0, photos: 0 };
                }
                employeeMap[task.employee_id].count++;
                employeeMap[task.employee_id].photos += task.photo_count;
            });

            const employeeStats = Object.values(employeeMap).sort((a, b) => b.count - a.count);
            const maxCount = employeeStats[0]?.count || 1;

            document.getElementById('employeeStats').innerHTML = employeeStats.map(emp => {
                const percentage = (emp.count / maxCount) * 100;
                return `<div><div class="flex items-center justify-between mb-1"><span class="text-sm font-bold text-gray-700">${emp.name}</span><span class="text-sm text-gray-600">${emp.count}회 (${emp.photos}장)</span></div><div class="bg-gray-200 rounded-full h-2"><div class="bg-blue-600 h-2 rounded-full" style="width: ${percentage}%"></div></div></div>`;
            }).join('');

            const locationMap = {};
            allTasks.forEach(task => {
                if (!locationMap[task.location_id]) {
                    locationMap[task.location_id] = { name: task.location_name, count: 0, photos: 0 };
                }
                locationMap[task.location_id].count++;
                locationMap[task.location_id].photos += task.photo_count;
            });

            const locationStats = Object.values(locationMap).sort((a, b) => b.count - a.count);
            const maxLocCount = locationStats[0]?.count || 1;

            document.getElementById('locationStats').innerHTML = locationStats.map(loc => {
                const percentage = (loc.count / maxLocCount) * 100;
                return `<div><div class="flex items-center justify-between mb-1"><span class="text-sm font-bold text-gray-700">${loc.name}</span><span class="text-sm text-gray-600">${loc.count}회 (${loc.photos}장)</span></div><div class="bg-gray-200 rounded-full h-2"><div class="bg-green-600 h-2 rounded-full" style="width: ${percentage}%"></div></div></div>`;
            }).join('');

            const weeklyMap = {};
            const today = new Date();
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today.getTime() - i * 24 * 60 * 60 * 1000);
                const dateStr = date.toISOString().split('T')[0];
                weeklyMap[dateStr] = { date: dateStr, label: date.toLocaleDateString('ko-KR', { month: 'short', day: 'numeric' }), count: 0 };
            }

            allTasks.forEach(task => {
                const dateStr = task.submitted_at.split('T')[0];
                if (weeklyMap[dateStr]) weeklyMap[dateStr].count++;
            });

            const weeklyStats = Object.values(weeklyMap);
            const maxWeekCount = Math.max(...weeklyStats.map(d => d.count), 1);

            document.getElementById('weeklyStats').innerHTML = weeklyStats.map(day => {
                const height = (day.count / maxWeekCount) * 100;
                return `<div class="flex items-end gap-2"><span class="text-sm text-gray-600 w-16">${day.label}</span><div class="flex-1 bg-gray-200 rounded h-8 relative"><div class="bg-blue-600 rounded h-full" style="width: ${height}%"></div><span class="absolute right-2 top-1 text-xs text-gray-700 font-bold">${day.count}</span></div></div>`;
            }).join('');
        }

        function populateFilters() {
            const locations = [...new Set(allTasks.map(t => JSON.stringify({ id: t.location_id, name: t.location_name })))].map(s => JSON.parse(s));

            const locationSelects = ['galleryLocation', 'recordLocation'];
            locationSelects.forEach(id => {
                const select = document.getElementById(id);
                locations.forEach(loc => {
                    const option = document.createElement('option');
                    option.value = loc.id;
                    option.textContent = loc.name;
                    select.appendChild(option);
                });
            });

            const employees = [...new Set(allTasks.map(t => JSON.stringify({ id: t.employee_id, name: t.employee_name })))].map(s => JSON.parse(s));

            const employeeSelect = document.getElementById('recordEmployee');
            employees.forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.id;
                option.textContent = emp.name;
                employeeSelect.appendChild(option);
            });
        }

        function formatDateTime(isoString) {
            const date = new Date(isoString);
            return date.toLocaleString('ko-KR', { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
        }

        function openModal(url) {
            document.getElementById('modalImage').src = url;
            document.getElementById('photoModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('photoModal').style.display = 'none';
        }
    </script>
</body>
</html>
